# Palette CMS Content Sync

[![License](https://img.shields.io/badge/license-MIT-green.svg?style=flat)](https://raw.githubusercontent.com/IBM-Bluemix/vscode-log-output-colorizer/master/LICENSE)

*※この拡張機能は[パレットCMS](https://palettecms.jp/)専用です。*

---

## 概要

VS Code上で[パレットCMS](https://palettecms.jp/)用のWEBコンテンツの作成や編集と同期を可能にする拡張機能です。

## セットアップ

1. パレットCMSに管理者（admin）としてログインします。
1. システム設定から`コンテンツカテゴリ`ページに移動します。
1. `ZIPダウンロード`をクリックしてZIPファイルをダウンロードします。
1. ダウンロードしたZIPファイルを解凍します。
1. VS Codeで解凍したフォルダを開きます。

### 表示位置の調整

VS Codeは拡張機能の表示位置を自由に変更できます。

サイドバーから*Palette CMS Content Sync*パネルを開き、拡張機能のアイコンをドラッグして任意の位置に移動します。

ウインドウの右側に移動すると、ファイル一覧とコンテンツの設定を同時に確認できて便利です。

![](/media/doc/move_extension.gif)

## 使用方法

### プレビュー

1. ツールバーから`プレビュー`ボタンをクリックします。
1. 開いているHTMLファイルに応じてプレビューに表示される内容が自動的に切り替わります。
1. ファイルを保存すると、変更内容が即座にプレビューに反映されます。

![](/media/doc/preview.gif)

### コンテンツ変数を挿入

1. ダウンロードしたフォルダ内のHTMLファイルを開きます。
1. `[`キーを入力するとコンテンツ変数のサジェストが表示されます。

![](/media/doc/content_variables.gif)

### コンテンツ設定を変更

1. サイドバーから*Palette CMS Content Sync*パネルを開きます。
1. HTMLファイルまたは`contents.json`を開くと、開いたコンテンツの設定が表示されます。
1. 設定を変更すると、自動的に保存されます。

> ✅ この時点では、まだ設定内容はサーバーにアップロードされていないため、安全に変更できます。

![](/media/doc/content_settings.png)

### アップロード

1. 任意のHTMLファイルまたは`contents.json`を開きます。
1. ツールバーから`アップロード`ボタンをクリックします。
1. アップロードが成功すると、サーバーにHTMLとコンテンツ設定が反映されます。

![](/media/doc/upload_content.png)

コンテンツ設定にエラーがある場合は、エラーダイアログが表示されます。

![](/media/doc/error.png)

### ダウンロード

1. 任意のHTMLファイルまたは`contents.json`を開きます。
1. ツールバーから`ダウンロード`ボタンをクリックします。
1. ローカルのHTMLとコンテンツ設定がサーバー上のデータで上書きされます。

> ⚠️ 先にHTMLや設定をアップロードしなかった場合、ローカルの変更内容は失われます。

![](/media/doc/download_content.png)

### 新規コンテンツの作成

1. ツールバーから`新規作成`ボタンをクリックします。

> ✅ コンテンツをアップロードした後、空のHTMLファイルが自動的に生成されます。
>
> ✅ システムIDやその他いくつかの項目はサーバー側で自動的に生成され、ローカルに反映されます。

### コンテンツの複製

1. ツールバーから`複製`ボタンをクリックします。

### コンテンツの削除

1. ツールバーから`削除`ボタンをクリックします。

> ⚠️ サーバー側のデータは永久に削除されます。

> ✅ ローカルのデータだけ削除したい場合は、ファイルブラウザから削除してください。

### フォルダ名の変更

1. ツールバーから`フォルダ名を更新`ボタンをクリックすると、コンテンツIDでフォルダ名が変更されます。

> ✅ 日本語名を含む任意の名前に変更できます。

![](/media/doc/rename_folder.png)

### 拡張子の変更

1. すべての拡張子を一括で変更したい場合は、ツールバーから`拡張子を変更`ボタンをクリックしてください。

> ✅ この機能により、`HTTPヘッダー｜Content-Type`を変更した後、すべての拡張子を簡単に変更できます。

### コンテンツ変数一覧の再取得

1. ツールバーから`コンテンツ変数を再取得`ボタンをクリックして、コンテンツ変数一覧をダウンロードします。

> ✅ コンテンツをダウンロードした時も、再度コンテンツ変数一覧が取得されます。
>
> ⚠️ Palette CMSで新しい任意項目を追加した場合、コンテンツ変数一覧を再取得する必要があります。

### すべての定義の再取得

1. ツールバーから`定義ファイルを再取得`ボタンをクリックして、定義ファイルをダウンロードします。

> ⚠️ Palette CMSで新しいシートを追加した場合などに、定義ファイルを再取得する必要があります。